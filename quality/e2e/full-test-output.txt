Logging in to HA via form...
✅ Panel loaded. Auth verified.
Auth state saved to /sessions/wizardly-stoic-cannon/mnt/vulcan-brownout/quality/e2e/playwright/.auth/auth.json

Running 69 tests using 2 workers

Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
Panel element not yet attached after 15s
  ✘   2 [chromium] › tests/dark-mode.spec.ts:12:7 › Vulcan Brownout - Dark Mode › should render in light mode by default (22.2s)
  ✘   1 [chromium] › tests/dark-mode.spec.ts:30:7 › Vulcan Brownout - Dark Mode › should render in dark mode when emulated (22.2s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
Panel element not yet attached after 15s
  ✘   4 [chromium] › tests/dark-mode.spec.ts:79:7 › Vulcan Brownout - Dark Mode › should apply dark mode CSS custom properties (1.0m)
  ✘   3 [chromium] › tests/dark-mode.spec.ts:50:7 › Vulcan Brownout - Dark Mode › should respond to prefers-color-scheme media query (1.0m)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
Panel element not yet attached after 15s
  ✘   5 [chromium] › tests/dark-mode.spec.ts:123:7 › Vulcan Brownout - Dark Mode › should toggle dark mode via button (22.2s)
  ✘   6 [chromium] › tests/dark-mode.spec.ts:103:7 › Vulcan Brownout - Dark Mode › should render device items with appropriate colors in dark mode (22.2s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
Panel element not yet attached after 15s
  ✘   7 [chromium] › tests/dark-mode.spec.ts:149:7 › Vulcan Brownout - Dark Mode › should persist dark mode preference in storage (22.0s)
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘   9 [chromium] › tests/dark-mode.spec.ts:197:7 › Vulcan Brownout - Dark Mode › should apply dark mode to modals (21.9s)
Login page detected, authenticating...
  ✘   8 [chromium] › tests/dark-mode.spec.ts:173:7 › Vulcan Brownout - Dark Mode › should update text contrast for accessibility in dark mode (1.0m)
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  10 [chromium] › tests/dark-mode.spec.ts:223:7 › Vulcan Brownout - Dark Mode › should maintain dark mode across modal open/close (21.9s)
Login page detected, authenticating...
Panel element not yet attached after 15s
Panel element not yet attached after 15s
  ✘  12 [chromium] › tests/dark-mode.spec.ts:275:7 › Vulcan Brownout - Dark Mode › should work with high contrast mode (27.0s)

=== Starting Debug Test ===
Target URL: http://homeassistant.lan:8123/vulcan-brownout
Step 1: Navigating to panel...
Current URL: http://homeassistant.lan:8123/vulcan-brownout
Step 2: Already authenticated
Step 3: Capturing page HTML...
HTML saved (37500 bytes)
Step 4: Checking for DOM elements...
HA shell elements: 1
vulcan-brownout-panel elements: 1
Step 5: Analyzing page structure...

=== Page Structure ===
{
  "documentTitle": "Battery Monitoring – Home Assistant",
  "bodyClass": "",
  "htmlLang": "en",
  "hasHomeAssistant": true,
  "hasPanelElement": false,
  "rootElements": [
    {
      "tag": "html",
      "class": ""
    }
  ],
  "foundCustomElements": [
    "home-assistant",
    "action-handler"
  ],
  "undefinedElements": []
}
=== End Structure ===

Step 6: Taking screenshot...
Screenshot saved

=== HTML snippet around panel ===
 fixed; width: 50px; height: 50px; transform: translate(-50%, -50%) scale(0); pointer-events: none; z-index: 999; background: var(--primary-color); opacity: 0.2; border-radius: 50%; transition: transform 180ms ease-in-out;"></action-handler><script async="" type="module" src="/vulcan_brownout_panel/vulcan-brownout-panel.js"></script></body></html>
=== End snippet ===

Step 7: Saving diagnostic data...

=== SUMMARY ===
Console messages: 0
JS errors: 0
HA shell found: YES
Panel found: YES
HTML size: 37500 bytes

Output files:
  - console-logs.json (2 bytes)
  - debug-screenshot.png (63469 bytes)
  - js-errors.json (2 bytes)
  - page-content.html (37502 bytes)
  - page-structure.json (335 bytes)
=== END SUMMARY ===

  ✓  13 [chromium] › tests/debug-panel.spec.ts:24:5 › Debug: vulcan-brownout-panel rendering (3.4s)
Login page detected, authenticating...
  ✘  11 [chromium] › tests/dark-mode.spec.ts:246:7 › Vulcan Brownout - Dark Mode › should handle theme switching during scroll (1.0m)
Panel element not yet attached after 15s
  ✘  14 [chromium] › tests/device-list.spec.ts:12:7 › Vulcan Brownout - Device List › should display device list with correct data (22.0s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  15 [chromium] › tests/device-list.spec.ts:34:7 › Vulcan Brownout - Device List › should display device attributes correctly (22.1s)
Panel element not yet attached after 15s
  ✘  16 [chromium] › tests/device-list.spec.ts:51:7 › Vulcan Brownout - Device List › should filter devices by search term (22.0s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  17 [chromium] › tests/device-list.spec.ts:78:7 › Vulcan Brownout - Device List › should clear filter and restore full list (21.9s)
Panel element not yet attached after 15s
  ✘  18 [chromium] › tests/device-list.spec.ts:104:7 › Vulcan Brownout - Device List › should display device in correct visual order (21.9s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  19 [chromium] › tests/device-list.spec.ts:121:7 › Vulcan Brownout - Device List › should handle large device lists (21.9s)
Panel element not yet attached after 15s
  ✘  20 [chromium] › tests/device-list.spec.ts:136:7 › Vulcan Brownout - Device List › should verify device item clickability (22.0s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  21 [chromium] › tests/device-list.spec.ts:154:7 › Vulcan Brownout - Device List › should display battery levels for all devices (21.9s)
Panel element not yet attached after 15s
  ✘  22 [chromium] › tests/device-list.spec.ts:174:7 › Vulcan Brownout - Device List › should verify device type icons are displayed (21.9s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  23 [chromium] › tests/device-list.spec.ts:192:7 › Vulcan Brownout - Device List › should preserve list state after interactions (22.0s)
Panel element not yet attached after 15s
  ✘  24 [chromium] › tests/device-list.spec.ts:215:7 › Vulcan Brownout - Device List › should display loading state during filter (22.0s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  25 [chromium] › tests/infinite-scroll.spec.ts:12:7 › Vulcan Brownout - Infinite Scroll › should load initial page of devices (22.0s)
Panel element not yet attached after 15s
  ✘  26 [chromium] › tests/infinite-scroll.spec.ts:27:7 › Vulcan Brownout - Infinite Scroll › should load next page when scrolling to bottom (21.8s)
Login page detected, authenticating...
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  27 [chromium] › tests/infinite-scroll.spec.ts:52:7 › Vulcan Brownout - Infinite Scroll › should load multiple pages progressively (22.0s)
Panel element not yet attached after 15s
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  28 [chromium] › tests/infinite-scroll.spec.ts:81:7 › Vulcan Brownout - Infinite Scroll › should not load beyond final page (1.0m)
Login page detected, authenticating...
  ✘  29 [chromium] › tests/infinite-scroll.spec.ts:108:7 › Vulcan Brownout - Infinite Scroll › should maintain scroll position during load (1.0m)
Panel element not yet attached after 15s
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  31 [chromium] › tests/infinite-scroll.spec.ts:159:7 › Vulcan Brownout - Infinite Scroll › should handle empty remaining pages gracefully (22.0s)
Login page detected, authenticating...
  ✘  30 [chromium] › tests/infinite-scroll.spec.ts:132:7 › Vulcan Brownout - Infinite Scroll › should prevent duplicate device loading (1.0m)
Login page detected, authenticating...
Panel element not yet attached after 15s
Panel element not yet attached after 15s
  ✘  33 [chromium] › tests/infinite-scroll.spec.ts:203:7 › Vulcan Brownout - Infinite Scroll › should recover from scroll load error (22.0s)
Login page detected, authenticating...
  ✘  32 [chromium] › tests/infinite-scroll.spec.ts:182:7 › Vulcan Brownout - Infinite Scroll › should show loading indicator during scroll load (1.0m)
Panel element not yet attached after 15s
Login page detected, authenticating...
Panel element not yet attached after 15s
  ✘  35 [chromium] › tests/infinite-scroll.spec.ts:267:7 › Vulcan Brownout - Infinite Scroll › should work with large page sizes (21.8s)
Login page detected, authenticating...
  ✘  34 [chromium] › tests/infinite-scroll.spec.ts:242:7 › Vulcan Brownout - Infinite Scroll › should handle rapid scroll events (1.0m)
Login page detected, authenticating...
